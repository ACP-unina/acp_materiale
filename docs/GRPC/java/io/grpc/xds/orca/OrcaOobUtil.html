<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>OrcaOobUtil (grpc-all 1.72.0 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.min.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="OrcaOobUtil (grpc-all 1.72.0 API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":9,"i1":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/OrcaOobUtil.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">io.grpc.xds.orca</a></div>
<h2 title="Class OrcaOobUtil" class="title">Class OrcaOobUtil</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>io.grpc.xds.orca.OrcaOobUtil</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre><a href="../../ExperimentalApi.html" title="annotation in io.grpc">@ExperimentalApi</a>("https://github.com/grpc/grpc-java/issues/9129")
public final class <span class="typeNameLabel">OrcaOobUtil</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></pre>
<div class="block">Utility class that provides method for <a href="../../LoadBalancer.html" title="class in io.grpc"><code>LoadBalancer</code></a> to install listeners to receive
 out-of-band backend metrics in the format of Open Request Cost Aggregation (ORCA).</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="OrcaOobUtil.OrcaOobReportListener.html" title="interface in io.grpc.xds.orca">OrcaOobUtil.OrcaOobReportListener</a></span></code></th>
<td class="colLast">
<div class="block">The listener interface for receiving out-of-band ORCA reports from backends.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="OrcaOobUtil.OrcaReportingConfig.html" title="class in io.grpc.xds.orca">OrcaOobUtil.OrcaReportingConfig</a></span></code></th>
<td class="colLast">
<div class="block">Configuration for out-of-band ORCA reporting service RPC.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static <a href="../../LoadBalancer.Helper.html" title="class in io.grpc">LoadBalancer.Helper</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#newOrcaReportingHelper(io.grpc.LoadBalancer.Helper)">newOrcaReportingHelper</a></span>&#8203;(<a href="../../LoadBalancer.Helper.html" title="class in io.grpc">LoadBalancer.Helper</a>&nbsp;delegate)</code></th>
<td class="colLast">
<div class="block">Creates a new <a href="../../LoadBalancer.Helper.html" title="class in io.grpc"><code>LoadBalancer.Helper</code></a> with provided
 <a href="OrcaOobUtil.OrcaOobReportListener.html" title="interface in io.grpc.xds.orca"><code>OrcaOobUtil.OrcaOobReportListener</code></a> installed
 to receive callback when an out-of-band ORCA report is received.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setListener(io.grpc.LoadBalancer.Subchannel,io.grpc.xds.orca.OrcaOobUtil.OrcaOobReportListener,io.grpc.xds.orca.OrcaOobUtil.OrcaReportingConfig)">setListener</a></span>&#8203;(<a href="../../LoadBalancer.Subchannel.html" title="class in io.grpc">LoadBalancer.Subchannel</a>&nbsp;subchannel,
           <a href="OrcaOobUtil.OrcaOobReportListener.html" title="interface in io.grpc.xds.orca">OrcaOobUtil.OrcaOobReportListener</a>&nbsp;listener,
           <a href="OrcaOobUtil.OrcaReportingConfig.html" title="class in io.grpc.xds.orca">OrcaOobUtil.OrcaReportingConfig</a>&nbsp;config)</code></th>
<td class="colLast">
<div class="block">Update <a href="OrcaOobUtil.OrcaOobReportListener.html" title="interface in io.grpc.xds.orca"><code>OrcaOobUtil.OrcaOobReportListener</code></a> to receive Out-of-Band metrics report for the
  particular subchannel connection, and set the configuration of receiving ORCA reports,
  such as the interval of receiving reports.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang" class="externalLink">wait</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="newOrcaReportingHelper(io.grpc.LoadBalancer.Helper)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>newOrcaReportingHelper</h4>
<pre class="methodSignature">public static&nbsp;<a href="../../LoadBalancer.Helper.html" title="class in io.grpc">LoadBalancer.Helper</a>&nbsp;newOrcaReportingHelper&#8203;(<a href="../../LoadBalancer.Helper.html" title="class in io.grpc">LoadBalancer.Helper</a>&nbsp;delegate)</pre>
<div class="block">Creates a new <a href="../../LoadBalancer.Helper.html" title="class in io.grpc"><code>LoadBalancer.Helper</code></a> with provided
 <a href="OrcaOobUtil.OrcaOobReportListener.html" title="interface in io.grpc.xds.orca"><code>OrcaOobUtil.OrcaOobReportListener</code></a> installed
 to receive callback when an out-of-band ORCA report is received.

 <p>Example usages:

 <ul>
   <li> Leaf policy (e.g., WRR policy)
     <pre>
       <code>
       class WrrLoadbalancer extends LoadBalancer {
         private final Helper originHelper;  // the original Helper

         public Status acceptResolvedAddresses(ResolvedAddresses resolvedAddresses) {
           // listener implements the logic for WRR's usage of backend metrics.
           OrcaReportingHelper orcaHelper =
               OrcaOobUtil.newOrcaReportingHelper(originHelper);
           Subchannel subchannel =
               orcaHelper.createSubchannel(CreateSubchannelArgs.newBuilder()...);
           OrcaOobUtil.setListener(
              subchannel,
              listener,
              OrcaRerportingConfig.newBuilder().setReportInterval(30, SECOND).build());
           ...
         }
       }
       </code>
     </pre>
   </li>
   <li> Delegating policy doing per-child-policy aggregation
     <pre>
       <code>
       class XdsLoadBalancer extends LoadBalancer {
         private final Helper orcaHelper;  // the original Helper

         public XdsLoadBalancer(LoadBalancer.Helper helper) {
           this.orcaHelper = OrcaUtil.newOrcaReportingHelper(helper);
         }
         private void createChildPolicy(
             Locality locality, LoadBalancerProvider childPolicyProvider) {
           // Each Locality has a child policy, and the parent does per-locality aggregation by
           // summing everything up.

           // Create an OrcaReportingHelperWrapper for each Locality.
           // listener implements the logic for locality-level backend metric aggregation.
           LoadBalancer childLb = childPolicyProvider.newLoadBalancer(
             new ForwardingLoadBalancerHelper() {
               public Subchannel createSubchannel(CreateSubchannelArgs args) {
                 Subchannel subchannel = super.createSubchannel(args);
                 OrcaOobUtil.setListener(subchannel, listener,
                 OrcaReportingConfig.newBuilder().setReportInterval(30, SECOND).build());
                 return subchannel;
               }
               public LoadBalancer.Helper delegate() {
                 return orcaHelper;
               }
             });
         }
       }
       </code>
     </pre>
   </li>
 </ul></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>delegate</code> - the delegate helper that provides essentials for establishing subchannels to
     backends.</dd>
</dl>
</li>
</ul>
<a id="setListener(io.grpc.LoadBalancer.Subchannel,io.grpc.xds.orca.OrcaOobUtil.OrcaOobReportListener,io.grpc.xds.orca.OrcaOobUtil.OrcaReportingConfig)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>setListener</h4>
<pre class="methodSignature">public static&nbsp;void&nbsp;setListener&#8203;(<a href="../../LoadBalancer.Subchannel.html" title="class in io.grpc">LoadBalancer.Subchannel</a>&nbsp;subchannel,
                               <a href="OrcaOobUtil.OrcaOobReportListener.html" title="interface in io.grpc.xds.orca">OrcaOobUtil.OrcaOobReportListener</a>&nbsp;listener,
                               <a href="OrcaOobUtil.OrcaReportingConfig.html" title="class in io.grpc.xds.orca">OrcaOobUtil.OrcaReportingConfig</a>&nbsp;config)</pre>
<div class="block">Update <a href="OrcaOobUtil.OrcaOobReportListener.html" title="interface in io.grpc.xds.orca"><code>OrcaOobUtil.OrcaOobReportListener</code></a> to receive Out-of-Band metrics report for the
  particular subchannel connection, and set the configuration of receiving ORCA reports,
  such as the interval of receiving reports. Set listener to null to remove listener, and the
  config will have no effect.

 <p>This method needs to be called from the SynchronizationContext returned by the wrapped
 helper's <a href="../../LoadBalancer.Helper.html#getSynchronizationContext()"><code>LoadBalancer.Helper.getSynchronizationContext()</code></a>.

 <p>Each load balancing policy must call this method to configure the backend load reporting.
 Otherwise, it will not receive ORCA reports.

 <p>If multiple load balancing policies configure reporting with different intervals, reports
 come with the minimum of those intervals.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>subchannel</code> - the server connected by this subchannel to receive the metrics.</dd>
<dd><code>listener</code> - the callback upon receiving backend metrics from the Out-Of-Band stream.
                 Setting to null to removes the listener from the subchannel.</dd>
<dd><code>config</code> - the configuration to be set. It has no effect when listener is null.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/OrcaOobUtil.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
